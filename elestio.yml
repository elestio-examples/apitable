ports:
  - protocol: "HTTPS"
    targetProtocol: "HTTP"
    listeningPort: "443"
    targetPort: "7538"
    targetIP: "172.17.0.1"
    public: true
    path: "/"
    isAuth: false
  - protocol: "HTTPS"
    targetProtocol: "HTTP"
    listeningPort: "8543"
    targetPort: "24781"
    targetIP: "172.17.0.1"
    public: true
    path: "/"
    isAuth: true
    login: "root"
    password: "random_password"
  - protocol: "TCP"
    targetProtocol: "TCP"
    listeningPort: "23060"
    targetIP: "172.17.0.1"
    targetPort: "3306"
    public: true
environments:
  - key: "ADMIN_EMAIL"
    value: "[EMAIL]"
  - key: "ADMIN_PASSWORD"
    value: "random_password"
  - key: "IMAGE_REGISTRY"
    value: "docker.io"
  - key: "IMAGE_INIT_DB"
    value: "apitable/init-db:latest"
  - key: "IMAGE_INIT_DATA_MYSQL"
    value: "apitable/init-template-mysql:latest"
  - key: "IMAGE_INIT_DATA_MINIO"
    value: "apitable/init-template-minio:latest"
  - key: "IMAGE_WEB_SERVER"
    value: "apitable/web-server:latest"
  - key: "IMAGE_BACKEND_SERVER"
    value: "apitable/backend-server:latest"
  - key: "IMAGE_ROOM_SERVER"
    value: "apitable/room-server:latest"
  - key: "IMAGE_SOCKET_SERVER"
    value: "apitable/socket-server:latest"
  - key: "IMAGE_IMAGEPROXY_SERVER"
    value: "apitable/imageproxy-server:latest"
  - key: "IMAGE_MINIO"
    value: "minio/minio:RELEASE.2023-01-25T00-19-54Z"
  - key: "IMAGE_REDIS"
    value: "elestio/redis:7.0"
  - key: "IMAGE_RABBITMQ"
    value: "elestio/rabbitmq:latest"
  - key: "IMAGE_MYSQL"
    value: "elestio/mysql:8.0"
  - key: "IMAGE_GATEWAY"
    value: "apitable/openresty:latest"
  - key: "BACKEND_BASE_URL"
    value: "http://backend-server:8081/api/v1/"
  - key: "SOCKET_GRPC_URL"
    value: "room-server:3007"
  - key: "NEST_GRPC_URL"
    value: "room-server:3334"
  - key: "OSS_HOST"
    value: "assets"
  - key: "OSS_TYPE"
    value: "QNY1"
  - key: "OSS_CACHE_TYPE"
    value: "minio"
  - key: "MINIO_ACCESS_KEY"
    value: "apitable"
  - key: "MINIO_SECRET_KEY"
    value: "random_password"
  - key: "MINIO_ENDPOINT"
    value: "http://minio:9000"
  - key: "MINIO_BUCKET"
    value: "assets"
  - key: "MYSQL_HOST"
    value: "mysql"
  - key: "MYSQL_PORT"
    value: "3306"
  - key: "MYSQL_USERNAME"
    value: "root"
  - key: "MYSQL_PASSWORD"
    value: "random_password"
  - key: "MYSQL_DATABASE"
    value: "apitable"
  - key: "MYSQL_ROOT_PASSWORD"
    value: "random_password"
  - key: "DB_HOST"
    value: "mysql"
  - key: "DB_NAME"
    value: "apitable"
  - key: "DB_PASSWORD"
    value: "random_password"
  - key: "DB_PORT"
    value: "3306"
  - key: "DB_USERNAME"
    value: "root"
  - key: "DATABASE_TABLE_PREFIX"
    value: "apitable_"
  - key: "REDIS_HOST"
    value: "redis"
  - key: "REDIS_PORT"
    value: "6379"
  - key: "REDIS_PASSWORD"
    value: "random_password"
  - key: "REDIS_DB"
    value: "0"
  - key: "RABBITMQ_HOST"
    value: "rabbitmq"
  - key: "RABBITMQ_PORT"
    value: "5672"
  - key: "RABBITMQ_USERNAME"
    value: "apitable"
  - key: "RABBITMQ_PASSWORD"
    value: "random_password"
  - key: "RABBITMQ_VHOST"
    value: "/"
  - key: "RABBITMQ_DEFAULT_USER"
    value: "apitable-user"
  - key: "RABBITMQ_DEFAULT_PASS"
    value: "fkJifev64y^sbxRl"
  - key: "TIMEZONE"
    value: "Asia/Singapore"
  - key: "ENV"
    value: "apitable"
  - key: "PUBLIC_URL"
    value: "https://[CI_CD_DOMAIN]"
  - key: "TEMPLATE_PATH"
    value: "./static/web_build/index.html"
  - key: "BACKEND_INFO_URL"
    value: "http://backend-server:8081/api/v1/client/info"
  - key: "API_PROXY"
    value: "http://backend-server:8081"
  - key: "USE_CUSTOM_PUBLIC_FILES"
    value: "true"
  - key: "NEST_GRPC_ADDRESS"
    value: "static://room-server:3334"
  - key: "SERVER_DOMAIN"
    value: "https://[CI_CD_DOMAIN]"
  - key: "CALLBACK_DOMAIN"
    value: "https://[CI_CD_DOMAIN]"
  - key: "CORS_ORIGINS"
    value: "*"
  - key: "SOCKET_DOMAIN"
    value: "http://room-server:3333/socket"
  - key: "TEMPLATE_SPACE"
    value: "spcNTxlv8Drra"
  - key: "SOCKET_URL"
    value: "http://room-server:3002"
  - key: "SOCKET_RECONNECTION_ATTEMPTS"
    value: "10"
  - key: "SOCKET_RECONNECTION_DELAY"
    value: "500"
  - key: "SOCKET_TIMEOUT"
    value: "5000"
  - key: "SMS_ENABLED"
    value: "false"
  - key: "MAIL_ENABLED"
    value: "true"
  - key: "MAIL_SSL_ENABLE"
    value: "false"
  - key: "MAIL_TYPE"
    value: "smtp"
  - key: "OSS_ENABLED"
    value: "true"
  - key: "AWS_ACCESS_KEY"
    value: "apitable"
  - key: "AWS_ACCESS_SECRET"
    value: "random_password"
  - key: "AWS_ENDPOINT"
    value: "http://minio:9000"
  - key: "AWS_REGION"
    value: "us-east-1"
  - key: "VK_ASSETS_LTD_URL"
    value: "assets"
  - key: "DATA_PATH"
    value: "."
  - key: "IMAGE_INIT_APPDATA"
    value: "apitable/init-appdata:latest"
  - key: "SKIP_REGISTER_VALIDATE"
    value: "true"
  - key: "OSS_CLIENT_TYPE"
    value: "aws"
  - key: "HUAWEICLOUD_OBS_ACCESS_KEY"
    value: "apitable"
  - key: "HUAWEICLOUD_OBS_ENDPOINT"
    value: "obs.cn-south-1.myhuaweicloud.com"
  - key: "HUAWEICLOUD_OBS_SECRET_KEY"
    value: "random_password"
  - key: "ASSETS_BUCKET"
    value: "assets"
  - key: "ASSETS_URL"
    value: "assets"
  - key: "OSS_BUCKET_NAME"
    value: "assets"
  - key: "USE_NATIVE_MODULE"
    value: "0"
  - key: "DOMAIN"
    value: "[CI_CD_DOMAIN]"

config:
  runTime: "dockerCompose"
  version: ""
  framework: ""
  buildCommand: "docker-compose build"
  buildDir: "/"
  runCommand: "docker-compose up -d"
  icon: ""
  screenshot: "jenkins.jpg"
lifeCycleConfig:
  preInstallCommand: "./scripts/preInstall.sh"
  postInstallCommand: "./scripts/postInstall.sh"
  preBackupCommand: "./scripts/preBackup.sh"
  postBackupCommand: "./scripts/postBackup.sh"
  preRestoreCommand: "./scripts/preRestore.sh"
  postRestoreCommand: "./scripts/postRestore.sh"
webUI:
  - url: "https://[CI_CD_DOMAIN]"
    label: "Jenkins Admin"
    login: "[ADMIN_EMAIL]"
    password: "[ADMIN_PASSWORD]"
